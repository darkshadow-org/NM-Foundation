<script type="module">
  // Firebase SDKs from CDN
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
  import { getAuth, signInWithEmailAndPassword, createUserWithEmailAndPassword, sendPasswordResetEmail } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

  // Your Firebase Configuration (Replace 'x' with your actual keys)
  const firebaseConfig = {
    apiKey: "AIzaSyA9sXjrKKHry3acMvacLAEZShTiN0cO3OY",
  authDomain: "websitedds-b59e2.firebaseapp.com",
  projectId: "websitedds-b59e2",
  storageBucket: "websitedds-b59e2.firebasestorage.app",
  messagingSenderId: "163038706640",
  appId: "1:163038706640:web:eb5b838e9255290e3d57d5"
  };

  // Initialize Firebase
  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);

  // --- LOGIN FUNCTION ---
  window.handleLogin = async () => {
    const email = document.getElementById('l-email').value;
    const pass = document.getElementById('l-pass').value;
    const status = document.getElementById('status-text');

    status.innerText = "AUTHENTICATING...";
    try {
      await signInWithEmailAndPassword(auth, email, pass);
      status.innerText = "ACCESS_GRANTED";
      // Role-based Redirection
      if(email === "admin@nm.foundation") {
          window.location.href = "admin.html";
      } else {
          window.location.href = "dashboard.html";
      }
    } catch (error) {
      status.innerText = "AUTH_FAILED: " + error.code;
      alert("Neural Override Error: " + error.message);
    }
  };

  // --- SIGNUP FUNCTION ---
  window.handleSignup = async () => {
    const email = document.querySelectorAll('#signup-sec input')[1].value;
    const pass = document.querySelectorAll('#signup-sec input')[2].value;
    try {
      await createUserWithEmailAndPassword(auth, email, pass);
      alert("Identity Registered! Now Login.");
      location.reload();
    } catch (error) {
      alert("Registration Error: " + error.message);
    }
  };

  // --- RESET PASSWORD FUNCTION ---
  window.handleReset = async () => {
    const email = document.querySelector('#reset-sec input').value;
    try {
      await sendPasswordResetEmail(auth, email);
      alert("Override code sent to your neural mail (Check Inbox/Spam).");
    } catch (error) {
      alert("Reset Error: " + error.message);
    }
  };
</script>
